steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-ac37e296-eb04-4972-9682-e8cc671daf7b:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 10db9c29-58c2-4803-a9e4-f00ec294b799
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e1158559-aebd-4411-b57b-7deb8dc51aa4
                    stepCounter: 0d3018fb-af1c-48fa-8cad-0d651bc81527
                transform: ""
          - columnReference:
              columnCounter: d32403b8-e0db-475f-843f-02d836fdf089
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 49c8262c-15d5-43a6-ab0e-ec17e8afefeb
                    stepCounter: 63748bea-6ebd-4bc0-8789-997e926f9acd
                transform: ""
          - columnReference:
              columnCounter: b25f5358-656c-457e-a628-db4863bb3ef1
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 913538a1-0e1d-4db6-b499-1efb9f803d9a
                    stepCounter: f7b3f4f2-e506-4a7f-b9a3-c54f28469e3d
                transform: ""
          - columnReference:
              columnCounter: 7770733a-40e2-4298-be1c-d2d21d0154b6
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(38,0)
            description: ""
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5b4597bf-adbb-4a69-9d89-16e67c7f3ae9
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 0d77350c-768a-4077-8e61-d30a642bf7ef
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(38,0)
            description: ""
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d6144ec7-84d5-4a1a-a851-b0021acbdeeb
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 6382745a-ec72-4d8b-a53b-ca804fb8e658
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(38,0)
            description: ""
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 52bdf7ef-bbca-4fad-84ff-1cef395aaa84
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 39f9cee2-a89f-47a8-b04f-8c882045f0c0
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(38,0)
            description: ""
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0ad0b4c3-c9b4-49db-98c8-854c1c6e8cb6
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 9dc3ffd5-5ae9-4aef-a47f-9538696d8171
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(38,0)
            description: ""
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 93e45090-ec4a-4e3d-b763-eac0da5a69e8
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 9e9068f9-f849-4bee-9a6f-9357a0c482c6
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(12,2)
            description: ""
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a69c181f-f860-4838-99c7-16b2c8ff7466
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 25969f4f-aadc-419d-afb7-6ad4ab8cfe3e
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(12,2)
            description: ""
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 334abb04-ab09-4823-800b-f7ffc3b4ee86
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: f41f304e-8b07-4d08-8930-029e170f8b99
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(12,2)
            description: ""
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 19bb6195-58c0-46c5-b31e-d257db9045f9
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: d5587bd4-6c37-4786-9c2d-962100fd24b0
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(12,2)
            description: ""
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 117b23a7-c348-48ea-8adc-b30ccdb32f90
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 084b21c7-3ec9-4f4e-a792-6054976af40e
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: VARCHAR(1)
            description: ""
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5b068708-79fd-4cd8-b933-47bc10aa736c
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: c2fd995f-ee16-4e2b-aa23-8520b767e089
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: VARCHAR(1)
            description: ""
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 568fa9af-1a81-4ac3-95b1-8abe5309b627
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 7254299a-3d91-4e5d-a996-804c480df245
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: DATE
            description: ""
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f20f0c6f-6746-4bbb-b48a-533ece81bbf9
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: d032e63c-5266-4b27-82f2-54c3520ed25e
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: DATE
            description: ""
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7ca62665-5f7e-47f0-a72d-52df5167649a
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 4b06ea06-d2c3-4266-a253-ce72152cb5e9
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: DATE
            description: ""
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: eed97289-3e30-4843-8d8d-2c3da6a90d6b
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 3551c39e-4ea8-4b57-a140-41f5c5903dd1
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: VARCHAR(25)
            description: ""
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bb6e58c7-0995-44ab-a9a2-ad51dd735c89
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 243b6d52-a334-423f-b947-dee73bc6ec0c
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: VARCHAR(10)
            description: ""
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7ef481f1-d411-4785-b4a5-144ea976071c
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: f89d2a2f-72bf-4678-a827-83d05a864487
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: VARCHAR(44)
            description: ""
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cafbfbe9-5d0e-4bea-99ed-08da95be3fc7
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: ef26d342-a7ec-4668-b6e1-c717f10516b1
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(38,0)
            description: ""
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ff40af03-51e0-4f45-91b0-f7c521257064
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 5ed9198d-e10a-42fc-b293-cc16b6de79fc
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: VARCHAR(1)
            description: ""
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 61e1bc55-ced8-48e3-8917-c26efdfcb5d2
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 997469c3-7f9c-4f56-8f0d-6dd3da3754d8
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(12,2)
            description: ""
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 55603af6-d578-4719-9339-6584c208a37b
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 3b59b985-3ad3-4e9a-8db8-ddd460b3b255
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: DATE
            description: ""
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 883a03dc-f010-4b73-b4af-ff68411d78e0
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: b11a303f-c4df-4423-8a74-205684bb80e1
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: VARCHAR(15)
            description: ""
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 03441184-c5ae-4aa5-9bc3-4065d5abe700
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: e890a0ae-f7eb-4bb2-9c78-43b76baf7111
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: VARCHAR(15)
            description: ""
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a85dc2f7-77c9-45c1-9ebc-3e39fd2bba5c
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: f82fd2c2-564d-4f98-ad19-c3a387fcaa07
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: VARCHAR(15)
            description: ""
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 504e3f66-ddbe-4080-af81-8a634b6e1aee
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: 90ca50bd-7159-42cc-9f83-52a7e1d30b9a
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(38,0)
            description: ""
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bf9bd464-187d-4b9a-a459-ba440f12c7a2
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: ed64b6ab-d10a-4b8a-89ec-fdcc666803fd
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: VARCHAR(79)
            description: ""
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 252487ad-b742-413f-b625-1def46a85b7a
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - columnReference:
              columnCounter: c2f680f3-36b9-4166-8fbb-7259ff3391c5
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER
            description: ""
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8faf3859-8058-47ea-bf0a-1036d8ea74ae
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 22355c3c-8c23-4984-90f7-2105d3118476
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f1f7b454-55bc-4610-b0ff-b5574a0342b1
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 0ef3cb92-9c7d-4438-adce-6080f84a3fe1
              stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c67565c4-1b5a-4c1f-8e3f-0391612536a3
                    stepCounter: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 0d3018fb-af1c-48fa-8cad-0d651bc81527
              DIM_PART: 63748bea-6ebd-4bc0-8789-997e926f9acd
              DIM_SUPPLIER: f7b3f4f2-e506-4a7f-b9a3-c54f28469e3d
              STG_LINEITEM_ORDERS: 62506510-50b8-4ebf-9b3c-e844db5c8ff0
              STG_PARTSUPP: d854aadd-f19e-4201-bb65-3c510294264e
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                
                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: ac37e296-eb04-4972-9682-e8cc671daf7b
